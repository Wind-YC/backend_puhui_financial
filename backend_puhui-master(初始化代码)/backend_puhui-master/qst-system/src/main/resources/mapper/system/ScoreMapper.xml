<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.qst.system.mapper.ScoreMapper">
    <resultMap id="ScoreResult" type="Score">
        <id column="score_id" property="scoreId"/>
        <result column="score_num"  property="scoreNum"/>
        <result column="com_id" property="comId"/>
        <result column="update_time" property="updateTime"/>
        <result column="update_detail" property="updateDetail"/>
        <result column="com_name" property="comName"/>
<!--        <association property="company" javaType="Company">-->
<!--            <id column="com_id" property="comId"/>-->
<!--            <result property="comNo" column="com_no"/>-->
<!--            <result property="comName" column="com_name"/>-->
<!--            <result property="comEmail" column="com_email"/>-->
<!--            <result property="comPhone" column="com_phone"/>-->
<!--            <result property="comPwd" column="com_pwd"/>-->
<!--            <result property="comRemark" column="com_remark"/>-->
<!--            <result property="comStatus" column="com_status"/>-->
<!--            <result property="comDel" column="com_del"/>-->
<!--        </association>-->
    </resultMap>
    <sql id="selectAll">
        select score_id,
               score_num,
               a.com_id,
               update_time,
               update_detail,
               c.com_name
        from score as a
        left join company as c on a.com_id=c.com_id
    </sql>
    <insert id="addScore">
        insert into score (
            <if test="comId != null and comId != ''">
                com_id
                <if test="scoreNum != null and scoreNum != ''">,score_num</if>
                <if test="updateDetail != null and updateDetail != ''">,update_detail</if>
            </if>
        ) values (
            <if test="comId != null and comId != ''">
                #{comId}
                <if test="scoreNum != null and scoreNum != ''">,#{scoreNum}</if>
                <if test="updateDetail != null and updateDetail != ''">,#{updateDetail}</if>
            </if>
        )
    </insert>
    <update id="update">
        update score
        <trim prefix="SET" suffixOverrides=",">
            <if test="comId!=null and comId!=''">
                com_id=#{comId},
                <if test="scoreNum!=null and scoreNum!=''">score_num=#{scoreNum},</if>
                <if test="updateDetail!=null and updateDetail!=''">update_detail=#{updateDetail},</if>
            </if>
        </trim>
        where score_id=#{scoreId}
    </update>
    <delete id="removeScoreById">
        delete from score
        where score_id in <foreach collection="list" item="id" open="(" close=")" separator=",">#{id}</foreach>
    </delete>

    <select id="selectScoreList" resultMap="ScoreResult">
        <include refid="selectAll"/>
        where com_del=0
        <if test="comId!=null and comId!=''">and a.com_id=#{comId}</if>
    </select>
    <select id="selectScoreById" resultMap="ScoreResult">
        <include refid="selectAll"/>
        where score_id=#{id}
    </select>
</mapper>